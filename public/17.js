(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"6nZ9":function(t,e,n){"use strict";n.r(e);var r=n("L2JU"),c=n("EmcK");function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a={name:"AccounSubscription",layout:function(t,e){return t(c.default,[e])},metaInfo:function(){return{title:"Subsription ".concat(this.account.at_username),titleTemplate:"%s - AcadaApp"}},data:function(){return{plan:{}}},props:{account:Object,plans:Array,payg:Object,stripe_pk:String},computed:s(s({},Object(r.c)({auth:function(t){return t.auth},authenticated:function(t){return t.authenticated}})),{},{processing:function(){return""!==this.process},errors:function(){return this.$page.errors}}),methods:{isSubscribed:function(t){return!!this.account.subscription&&t.id===this.account.subscription.subscription_plan_id},subscribe:function(t){this.plan=t,this.$refs.stripeGateway.open()},chargeCallback:function(t){var e=this;return new Promise((function(n,r){axios.post(e.route("subscription.subscribe",{account:e.account.username}),{token:t,plan:e.plan.id}).then((function(t){n(t)})).catch((function(t){r(t)}))}))},paymentSuccessful:function(t){t.data.subscription?(toastr.success("Subscription was successfull"),this.account.subscription=t.data.subscription):toastr.error("Subscription was not successfull"),this.closeGateway()},paymentError:function(t){toastr.error("There was an error "+t.message),this.closeGateway()},closeGateway:function(){this.plan={},this.$refs.stripeGateway.close()}}},u=n("KHd+"),p=Object(u.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-container",[n("stripe-gateway",{ref:"stripeGateway",attrs:{pk:t.stripe_pk,amount:t.plan.amount,currency:t.plan.currency,color:t.account.theme_color,charge_callback:t.chargeCallback},on:{success:t.paymentSuccessful,error:t.paymentError}}),t._v(" "),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{cols:"12",md:"8",lg:"6"}},[n("h4",[t._v("Subscriptions")]),t._v(" "),t.account.is_unlimited?[n("v-alert",{attrs:{icon:"info",prominent:"",text:"",type:"info"}},[t._v("\n                        You are currently on an unlimited plan\n                    ")])]:t.account.subscription?t._e():[n("v-alert",{attrs:{icon:"info",prominent:"",text:"",type:"info"}},[t._v("\n                        You are currently on the Pay As You Go Plan. Each course upload cost "+t._s(t._f("money")(t.payg.amount,t.payg.currency))+"\n                    ")])],t._v(" "),t.account.is_unlimited?t._e():n("v-expansion-panels",{attrs:{popout:"",focusable:""}},t._l(t.plans,(function(e){return n("v-expansion-panel",{key:e.id},[n("v-expansion-panel-header",[t._v("\n                        "+t._s(e.name)+"\n                        "),n("v-spacer"),t._v(" "),t.isSubscribed(e)&&!t.account.subscription.expired?n("v-icon",{attrs:{color:"success",title:"Currently subscribed"}},[t._v("check_circle")]):t.isSubscribed(e)&&t.account.subscription.expired?n("v-icon",{attrs:{color:"red",title:"Subscription expired"}},[t._v("report_problem")]):t._e()],1),t._v(" "),n("v-expansion-panel-content",[n("div",{staticClass:"m-3 text-center"},[t._v("\n                            "+t._s(e.description)+"\n                            "),n("div",[n("h1",[t._v(t._s(t._f("money")(e.amount,e.currency)))])]),t._v(" "),t.isSubscribed(e)?[t.account.subscription.expired?n("div",[n("v-alert",{attrs:{icon:"report_problem",prominent:"",text:"",type:"error","my-2":""}},[t._v("\n                                        Subscription expired\n                                    ")])],1):n("div",[n("v-alert",{attrs:{icon:"check_circle",prominent:"",text:"",type:"success","my-2":""}},[t._v("\n                                        You are currently subscribed\n                                    ")]),t._v("\n                                    "+t._s(t.account.subscription.start_time)+" - "+t._s(t.account.subscription.end_time)+", "+t._s(t.account.subscription.expiring_time)+" days remaining\n                                ")],1)]:t._e(),t._v(" "),!t.account.is_unlimited&&(!t.account.subscription||t.account.subscription&&t.account.subscription.expired)?[n("div",[n("v-btn",{attrs:{color:t.account.theme_color,dark:""},on:{click:function(n){return t.subscribe(e)}}},[t._v("Subscribe")])],1)]:t._e()],2)])],1)})),1)],2)],1)],1)],1)}),[],!1,null,null,null);e.default=p.exports}}]);